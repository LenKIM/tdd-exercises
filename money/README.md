##  다중 화폐를 지원하는 Money 객체 만들기


### 요구사항

# 다중 통화를 지원하는 Money 객체

>통화가 다른 두 금액을 더해서 주어진 환율에 맞게 변환 금액을 결과로 얻을 수 있어야 한다.
> 어떤 금액을 어떤 수에 곱한 금액을 결과로 얻을 수 있어야 한다.


캔트백은 Todo list를 만들면서 이를 실행한다.

1. 
```markdown
$5 + ₩10 = $10
~~$5 x 2 = $10~~
amount를 private하기 만들기
Dollar 부작용?
Money 반올림?
```


```markdown
단계들이 굉장히 작다고 느껴질 수 있는데,
TDD의 핵심은 작은 단계를 밟아야 한다는 것이 아니라, 이런 작은 단계를 밟을 능력을 갖추어야 한다는 것이다
작은 단계로 작업하는 방법을 배우면, 저절로 적절한 크기의 단계로 작업할 수 있게 된다
하지만 큰 단계로만 작업했다면, 더 작은 단계가 적절한 경우에 대해 결코 알지 못하게 된다
```

```markdown
$5 + ₩10 = $10
$5 x 2 = $10
amount를 private하기 만들기
Dollar 부작용?
Money 반올림?
**₩5 x 2 = ₩10**
```


Dollar와 Won 모두 중복이기 때문에 상위 클래스로 접근 지정자를 protected로 주어서 빼주었다. 
equals 또한 각 클래스에서 Money를 상속받고 있기 때문에 위의 코드와 같이 수정하면 중복을 빼 낼 수 있다. 
하지만 equals를 올리게 되니 Won과 Dollar를 비교하면 어떻게 될지 궁금해진다. 따라서 테스트 코드를 아래와 같이 작성해본다.

```markdown
$5 + ₩10 = $10
~~$5 x 2 = $10~~
~~amount를 private하기 만들기~~
~~Dollar 부작용?~~
Money 반올림?
₩5 x 2 = ₩10
~~equals 중복 제거~~
~~Won과 Dollar 비교하기~~
통화?
```

Dollar의 의존관계를 제거하고 Money에서 수행하게 하는 것이 맞다고 판단된다.

Money 라는 공통 클래스를 뽑아내는 것 까지는 헀으나,
여전히 Won, Dollar에 의존관계를 갖고있다.

이를 해결하기 위해서 currency 변수를 추가한다.

---

이제 `드디어, 더하기`

모든 Todo List 를 지우고, 

```
5$ + 5$ = 10$
```

책에 있는 내용을 정리하자면, $와 ₩의 합을 구하는데 있어서 다중 통화 사용에 대한 내용은 시스템의 나머지 코드에게 보이지 않도록 해야 한다고 합니다. 즉, 가지고 있는 객체가 우리가 원하지 않는 방식대로 동작하지 않는 경우라면 '그 객체와 외부 프로토콜이 같으면서 내부 구현은 다른 새로운 객체를 만들어야 한다'고 합니다.
우리 코드와 접목해보면 Money와 비슷하게 동작하지만 사실은 두 Money의 합을 나타내는 객체를 만들으라고 합니다. 덧셈을 하게 되면 연산의 결과로 Expression이 생기는데, 이 Expression을 환율을 이용해서 단일 통화로 축약한 것입니다. 이 메타포로 테스트 코드를 다시 작성하면 다음과 같이 됩니다. 

[참고 자료](https://dailyms.tistory.com/19?category=854582)


